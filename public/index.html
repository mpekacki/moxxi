<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"> -->
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"
        integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w=="
        crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/dark.css">
    <!-- <link rel="stylesheet" href="https://unpkg.com/sakura.css/css/sakura.css" type="text/css"> -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.js"></script>
</head>

<body>
    <div id="app" class="container">
        Your unique endpoint is <input v-model="serverUrl" readonly="true" size="50" onClick="this.select();" />
        <div v-for="request in requests" class="list-group-item">
            <hr>
            <table class="table">
                <tr>
                    <th colspan="2">Request</th>
                </tr>
                <tr>
                    <td>url</td>
                    <td>{{ request.url }}</td>
                </tr>
                <tr>
                    <td>method</td>
                    <td>{{ request.method }}</td>
                </tr>
                <tr>
                    <td>headers</td>
                    <td>{{ request.headers }}</td>
                </tr>
                <tr>
                    <td>params</td>
                    <td>{{ request.params }}</td>
                </tr>
                <tr>
                    <td>body</td>
                    <td>{{ request.body }}</td>
                </tr>
                <tr>
                    <th colspan="2">Response</th>
                </tr>
                <tr>
                    <td>response status code</td>
                    <td v-if="request.responseSent">{{ request.responseStatusCode }}</td>
                    <td v-else>
                        <input type="radio" id="100" value="100" v-model="request.responseStatusCode">
                        <label for="100">100 Continue</label><br />
                        <input type="radio" id="101" value="101" v-model="request.responseStatusCode">
                        <label for="101">101 Switching Protocols</label><br />
                        <input type="radio" id="102" value="102" v-model="request.responseStatusCode">
                        <label for="102">102 Processing</label><br />
                        <input type="radio" id="200" value="200" v-model="request.responseStatusCode">
                        <label for="200">200 OK</label><br />
                        <input type="radio" id="201" value="201" v-model="request.responseStatusCode">
                        <label for="201">201 Created</label><br />
                        <input type="radio" id="202" value="202" v-model="request.responseStatusCode">
                        <label for="202">202 Accepted</label><br />
                        <input type="radio" id="203" value="203" v-model="request.responseStatusCode">
                        <label for="203">203 Non-authoritative Information</label><br />
                        <input type="radio" id="204" value="204" v-model="request.responseStatusCode">
                        <label for="204">204 No Content</label><br />
                        <input type="radio" id="205" value="205" v-model="request.responseStatusCode">
                        <label for="205">205 Reset Content</label><br />
                        <input type="radio" id="206" value="206" v-model="request.responseStatusCode">
                        <label for="206">206 Partial Content</label><br />
                        <input type="radio" id="207" value="207" v-model="request.responseStatusCode">
                        <label for="207">207 Multi-Status</label><br />
                        <input type="radio" id="208" value="208" v-model="request.responseStatusCode">
                        <label for="208">208 Already Reported</label><br />
                        <input type="radio" id="226" value="226" v-model="request.responseStatusCode">
                        <label for="226">226 IM Used</label><br />
                        <input type="radio" id="300" value="300" v-model="request.responseStatusCode">
                        <label for="300">300 Multiple Choices</label><br />
                        <input type="radio" id="301" value="301" v-model="request.responseStatusCode">
                        <label for="301">301 Moved Permanently</label><br />
                        <input type="radio" id="302" value="302" v-model="request.responseStatusCode">
                        <label for="302">302 Found</label><br />
                        <input type="radio" id="303" value="303" v-model="request.responseStatusCode">
                        <label for="303">303 See Other</label><br />
                        <input type="radio" id="304" value="304" v-model="request.responseStatusCode">
                        <label for="304">304 Not Modified</label><br />
                        <input type="radio" id="305" value="305" v-model="request.responseStatusCode">
                        <label for="305">305 Use Proxy</label><br />
                        <input type="radio" id="307" value="307" v-model="request.responseStatusCode">
                        <label for="307">307 Temporary Redirect</label><br />
                        <input type="radio" id="308" value="308" v-model="request.responseStatusCode">
                        <label for="308">308 Permanent Redirect</label><br />
                        <input type="radio" id="400" value="400" v-model="request.responseStatusCode">
                        <label for="400">400 Bad Request</label><br />
                        <input type="radio" id="401" value="401" v-model="request.responseStatusCode">
                        <label for="401">401 Unauthorized</label><br />
                        <input type="radio" id="402" value="402" v-model="request.responseStatusCode">
                        <label for="402">402 Payment Required</label><br />
                        <input type="radio" id="403" value="403" v-model="request.responseStatusCode">
                        <label for="403">403 Forbidden</label><br />
                        <input type="radio" id="404" value="404" v-model="request.responseStatusCode">
                        <label for="404">404 Not Found</label><br />
                        <input type="radio" id="405" value="405" v-model="request.responseStatusCode">
                        <label for="405">405 Method Not Allowed</label><br />
                        <input type="radio" id="406" value="406" v-model="request.responseStatusCode">
                        <label for="406">406 Not Acceptable</label><br />
                        <input type="radio" id="407" value="407" v-model="request.responseStatusCode">
                        <label for="407">407 Proxy Authentication Required</label><br />
                        <input type="radio" id="408" value="408" v-model="request.responseStatusCode">
                        <label for="408">408 Request Timeout</label><br />
                        <input type="radio" id="409" value="409" v-model="request.responseStatusCode">
                        <label for="409">409 Conflict</label><br />
                        <input type="radio" id="410" value="410" v-model="request.responseStatusCode">
                        <label for="410">410 Gone</label><br />
                        <input type="radio" id="411" value="411" v-model="request.responseStatusCode">
                        <label for="411">411 Length Required</label><br />
                        <input type="radio" id="412" value="412" v-model="request.responseStatusCode">
                        <label for="412">412 Precondition Failed</label><br />
                        <input type="radio" id="413" value="413" v-model="request.responseStatusCode">
                        <label for="413">413 Payload Too Large</label><br />
                        <input type="radio" id="414" value="414" v-model="request.responseStatusCode">
                        <label for="414">414 Request-URI Too Long</label><br />
                        <input type="radio" id="415" value="415" v-model="request.responseStatusCode">
                        <label for="415">415 Unsupported Media Type</label><br />
                        <input type="radio" id="416" value="416" v-model="request.responseStatusCode">
                        <label for="416">416 Requested Range Not Satisfiable</label><br />
                        <input type="radio" id="417" value="417" v-model="request.responseStatusCode">
                        <label for="417">417 Expectation Failed</label><br />
                        <input type="radio" id="418" value="418" v-model="request.responseStatusCode">
                        <label for="418">418 I'm a teapot</label><br />
                        <input type="radio" id="421" value="421" v-model="request.responseStatusCode">
                        <label for="421">421 Misdirected Request</label><br />
                        <input type="radio" id="422" value="422" v-model="request.responseStatusCode">
                        <label for="422">422 Unprocessable Entity</label><br />
                        <input type="radio" id="423" value="423" v-model="request.responseStatusCode">
                        <label for="423">423 Locked</label><br />
                        <input type="radio" id="424" value="424" v-model="request.responseStatusCode">
                        <label for="424">424 Failed Dependency</label><br />
                        <input type="radio" id="426" value="426" v-model="request.responseStatusCode">
                        <label for="426">426 Upgrade Required</label><br />
                        <input type="radio" id="428" value="428" v-model="request.responseStatusCode">
                        <label for="428">428 Precondition Required</label><br />
                        <input type="radio" id="429" value="429" v-model="request.responseStatusCode">
                        <label for="429">429 Too Many Requests</label><br />
                        <input type="radio" id="431" value="431" v-model="request.responseStatusCode">
                        <label for="431">431 Request Header Fields Too Large</label><br />
                        <input type="radio" id="444" value="444" v-model="request.responseStatusCode">
                        <label for="444">444 Connection Closed Without Response</label><br />
                        <input type="radio" id="451" value="451" v-model="request.responseStatusCode">
                        <label for="451">451 Unavailable For Legal Reasons</label><br />
                        <input type="radio" id="499" value="499" v-model="request.responseStatusCode">
                        <label for="499">499 Client Closed Request</label><br />
                        <input type="radio" id="500" value="500" v-model="request.responseStatusCode">
                        <label for="500">500 Internal Server Error</label><br />
                        <input type="radio" id="501" value="501" v-model="request.responseStatusCode">
                        <label for="501">501 Not Implemented</label><br />
                        <input type="radio" id="502" value="502" v-model="request.responseStatusCode">
                        <label for="502">502 Bad Gateway</label><br />
                        <input type="radio" id="503" value="503" v-model="request.responseStatusCode">
                        <label for="503">503 Service Unavailable</label><br />
                        <input type="radio" id="504" value="504" v-model="request.responseStatusCode">
                        <label for="504">504 Gateway Timeout</label><br />
                        <input type="radio" id="505" value="505" v-model="request.responseStatusCode">
                        <label for="505">505 HTTP Version Not Supported</label><br />
                        <input type="radio" id="506" value="506" v-model="request.responseStatusCode">
                        <label for="506">506 Variant Also Negotiates</label><br />
                        <input type="radio" id="507" value="507" v-model="request.responseStatusCode">
                        <label for="507">507 Insufficient Storage</label><br />
                        <input type="radio" id="508" value="508" v-model="request.responseStatusCode">
                        <label for="508">508 Loop Detected</label><br />
                        <input type="radio" id="510" value="510" v-model="request.responseStatusCode">
                        <label for="510">510 Not Extended</label><br />
                        <input type="radio" id="511" value="511" v-model="request.responseStatusCode">
                        <label for="511">511 Network Authentication Required</label><br />
                        <input type="radio" id="599" value="599" v-model="request.responseStatusCode">
                        <label for="599">599 Network Connect Timeout Error</label><br />
                    </td>
                </tr>
                <tr>
                    <td>response json</td>
                    <td v-if="request.responseSent">{{ request.responseJson }}</td>
                    <td v-else>
                        <textarea v-model="request.responseJson"></textarea>
                    </td>
                </tr>
                <td>
                <td v-if="request.responseSent" class="text-success">response sent!</td>
                <td v-else>
                    <button @click="sendResponse(request)">send response</button>
                </td>
                </td>
            </table>
        </div>
</body>
<script>
    var app = new Vue({
        el: '#app',
        data: {
            serverId: '',
            serverUrl: '',
            requests: []
        },
        methods: {
            sendResponse: function (request) {
                ws.send(JSON.stringify({
                    requestKey: request.requestKey,
                    statusCode: request.responseStatusCode,
                    json: request.responseJson
                }));
                request.responseSent = true;
            }
        }
    });

    const ws = new WebSocket(location.origin.replace(/^http/, 'ws'));
    ws.onmessage = function (event) {
        console.log(app);
        const message = JSON.parse(event.data);
        if (message.requestKey) {
            const request = message;
            request.responseStatusCode = 200;
            request.responseJson = '{}';
            request.responseSent = false;
            app.requests.push(request);
        } else {
            app.serverId = message.serverId;
            app.serverUrl = location.origin + '/' + message.serverId;
        }
    }
</script>

</html>